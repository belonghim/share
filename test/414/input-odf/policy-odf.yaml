---
apiVersion: local.storage.openshift.io/v1
kind: LocalVolume
metadata:
  name: local-block-odf
  namespace: openshift-local-storage
spec:
  nodeSelector:
    nodeSelectorTerms:
    - matchExpressions:
      - key: cluster.ocs.openshift.io/openshift-storage
        operator: Exists
  storageClassDevices:
  - devicePaths:
    - /dev/disk/by-path/pci-0000:05:00.0
    storageClassName: localblock-odf
    volumeMode: Block
  tolerations:
  - effect: NoSchedule
    operator: Equal
    key: node.ocs.openshift.io/storage
    value: "true"
status:
  conditions:
    - status: "True"
      type: Available
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  namespace: openshift-storage
spec:
  config:
    nodeSelector:
      cluster.ocs.openshift.io/openshift-storage: ""
    tolerations:
    - effect: NoSchedule
      operator: Equal
      key: node.ocs.openshift.io/storage
      value: "true"
---
apiVersion: policy.open-cluster-management.io/v1
kind: ConfigurationPolicy
metadata:
  name: openshift-storage-subscripions
spec:
  remediationAction: enforce
  severity: high
  object-templates-raw: |
    {{- range $sb := (lookup "operators.coreos.com/v1alpha1" "Subscription" "openshift-storage" "").items }}
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: {{ $sb.metadata.name }}
          namespace: openshift-storage
        spec:
          config:
            nodeSelector:
              cluster.ocs.openshift.io/openshift-storage: ""
            tolerations:
            - effect: NoSchedule
              operator: Equal
              key: node.ocs.openshift.io/storage
              value: "true"
    {{- end }}
---
apiVersion: operator.openshift.io/v1
kind: Console
metadata:
  name: cluster
spec:
  plugins:
  - odf-console
