apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: placement-opp-clusters
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: vendor
          operator: In
          values:
          - OpenShift
        - key: local-cluster
          operator: NotIn
          values:
          - "true"
        - key: policies.undeploy
          operator: DoesNotExist
---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: placement-opp-hub
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: local-cluster
          operator: In
          values:
          - "true"
        - key: policies.undeploy
          operator: DoesNotExist
---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: sub-approval-automatic
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: vendor
          operator: In
          values:
          - OpenShift
        - key: policies.undeploy
          operator: DoesNotExist
        - key: policies.sub-approval
          operator: In
          values:
          - automatic
---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: sub-approval-manual
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: vendor
          operator: In
          values:
          - OpenShift
        - key: policies.undeploy
          operator: DoesNotExist
        - key: policies.sub-approval
          operator: In
          values:
          - manual
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: placement-opp-clusters
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: opp-clusters
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub2
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: placement-opp-hub
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: opp-hub
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub3
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: sub-approval-automatic
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: sub-approval-automatic
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub4
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: sub-approval-manual
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: sub-approval-manual
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-5 Security Alerts Advisories and
      Directives
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: acs-enf-central-ca-bundle
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: acs-inf-central-status
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: stackrox
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle2
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: ServiceAccount
            metadata:
              annotations:
                argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
              name: create-cluster-init
              namespace: stackrox
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle3
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: Role
            metadata:
              annotations:
                argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
                argocd.argoproj.io/sync-wave: "1"
              name: create-cluster-init
              namespace: stackrox
            rules:
            - apiGroups:
              - ""
              resources:
              - secrets
              verbs:
              - get
              - list
              - create
              - patch
              - update
            - apiGroups:
              - platform.stackrox.io
              resources:
              - securedclusters
              verbs:
              - get
              - list
              - patch
              - update
            - apiGroups:
              - route.openshift.io
              resources:
              - routes
              verbs:
              - get
              - list
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle4
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: RoleBinding
            metadata:
              annotations:
                argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
              name: create-cluster-init
              namespace: stackrox
            roleRef:
              apiGroup: rbac.authorization.k8s.io
              kind: Role
              name: create-cluster-init
            subjects:
            - kind: ServiceAccount
              name: create-cluster-init
              namespace: stackrox
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle5
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: imageregistry.operator.openshift.io/v1
            kind: Config
            metadata:
              name: cluster
            spec:
              managementState: Managed
              storage:
                emptyDir: {}
            status:
              conditions:
              - status: "True"
                type: Available
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle6
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: batch/v1
            kind: Job
            metadata:
              annotations:
                argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
                argocd.argoproj.io/sync-wave: "2"
              labels:
                init-bundle: central
              name: create-cluster-init-bundle-v2
              namespace: stackrox
            spec:
              template:
                metadata:
                  annotations:
                    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
                  labels:
                    init-bundle: central
                spec:
                  containers:
                  - command:
                    - /bin/bash
                    - -c
                    - "#!/usr/bin/env bash\nif kubectl get secret/sensor-tls &> /dev/null;
                      then\n  echo \"cluster-init bundle has already been configured,
                      doing nothing\"\n  exit 0\nelse\n\n  # Wait for central to be
                      ready\n  attempt_counter=0\n  max_attempts=20\n  echo \"Waiting
                      for central to be available...\"\n  until $(curl -k --output
                      /dev/null --silent --head --fail https://central); do\n      if
                      [ ${attempt_counter} -eq ${max_attempts} ];then\n        echo
                      \"Max attempts reached\"\n        exit 1\n      fi\n\n      printf
                      '.'\n      attempt_counter=$(($attempt_counter+1))\n      echo
                      \"Made attempt $attempt_counter, waiting...\"\n      sleep 5\n
                      \ done\n\n  # attempt to create init-bundle\n  # on failure
                      attempt to delete the bundle\n  attempt_counter=0\n  max_attempts=5\n
                      \ echo \"Configuring cluster-init bundle\"\n  \n  # set the
                      bundle name to include todays date\n  bundle_name=local-cluster-$(date
                      '+%Y%m%d')\n  export DATA={\\\"name\\\":\\\"$bundle_name\\\"}\n
                      \ until (curl -k -o /tmp/bundle.json -X POST -u \"admin:$PASSWORD\"
                      -H \"Content-Type: application/json\" --data $DATA --fail https://central/v1/cluster-init/init-bundles);
                      do\n      if [ ${attempt_counter} -eq ${max_attempts} ];then\n
                      \       echo \"Max attempts to create bundle reached\"\n        exit
                      1\n      fi\n\n      echo \"Check to see if there is an existing
                      bundle that can be revoked\"\n      curl -o /tmp/find_bundle.json
                      \ -k -X GET -u \"admin:$PASSWORD\" -H \"Content-Type: application/json\"
                      https://central/v1/cluster-init/init-bundles\n      bundle_id=$(cat
                      /tmp/find_bundle.json | python -c \"import sys, json; result
                      = [x for x in json.load(sys.stdin)[\\\"items\\\"] if x[\\\"name\\\"]==\\\"$bundle_name\\\"];
                      print(result[0][\\\"id\\\"])\")\n\n      echo \"-------------------------\"\n
                      \     echo \"bundle name is $bundle_name bundle id $bundle_id\"\n
                      \     echo \"-------------------------\"\n\n      if [ \"${bundle_id}\"
                      != \"\" ];then\n      echo \"executing revoke command\"\n        export
                      REVOKE=\"{\\\"ids\\\":[\\\"$bundle_id\\\"],\\\"confirmImpactedClustersIds\\\":[]}\"\n
                      \       curl -k -X PATCH -u \"admin:$PASSWORD\" -H \"Content-Type:
                      application/json\" --data $REVOKE https://central/v1/cluster-init/init-bundles/revoke\n
                      \     fi\n\n      printf '.'\n      attempt_counter=$(($attempt_counter+1))\n
                      \     echo \"Made create bundle attempt $attempt_counter, waiting...\"\n
                      \     sleep 5\n  done\n\n  echo \"Bundle received\"\n\n  if
                      [[ \"$OSTYPE\" == \"linux-gnu\"* ]]; then\n      BASE='base64
                      -w 0'\n  elif [[ \"$OSTYPE\" == \"darwin\"* ]]; then\n      BASE='base64'\n
                      \ fi\n\n  echo \"Applying bundle\"\n  # No jq in container,
                      python to the rescue\n  cat /tmp/bundle.json | python3 -c \"import
                      sys, json; print(json.load(sys.stdin)['kubectlBundle'])\" |
                      ${BASE} -d | oc apply -f -\n  ACS_HOST=\"$(oc get route central
                      -o custom-columns=HOST:.spec.host --no-headers):443\"\n  oc
                      patch secret sensor-tls --type='json' -p=\"[{\\\"op\\\" : \\\"add\\\",
                      \\\"path\\\" : \\\"/data/acs-host\\\", \\\"value\\\" : \\\"$(echo
                      $ACS_HOST | ${BASE})\\\"}]\"\n  echo \"ACS Cluster init bundle
                      generated and applied\"\nfi\n"
                    env:
                    - name: PASSWORD
                      valueFrom:
                        secretKeyRef:
                          key: password
                          name: central-htpasswd
                    image: image-registry.openshift-image-registry.svc:5000/openshift/cli:latest
                    imagePullPolicy: Always
                    name: create-cluster-init-bundle
                  dnsPolicy: ClusterFirst
                  restartPolicy: Never
                  serviceAccount: create-cluster-init
                  serviceAccountName: create-cluster-init
                  terminationGracePeriodSeconds: 30
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle7
      spec:
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: batch/v1
            kind: Job
            metadata:
              name: create-cluster-init-bundle
              namespace: stackrox
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SC System and Communications Protection
    policy.open-cluster-management.io/controls: SC-8 Transmission Confidentiality
      and Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: acs-enf-central-ca-bundle-expired
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: NonCompliant
    kind: Policy
    name: acs-inf-monitor-certs
    namespace: policies
  disabled: false
  policy-templates:
  - ignorePending: true
    objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle-expired
      spec:
        evaluationInterval:
          compliant: 1m
          noncompliant: 45s
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: v1
            kind: Secret
            metadata:
              name: sensor-tls
              namespace: stackrox
        remediationAction: enforce
        severity: medium
  - ignorePending: true
    objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle-expired2
      spec:
        evaluationInterval:
          compliant: 1m
          noncompliant: 45s
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: v1
            kind: Secret
            metadata:
              name: collector-tls
              namespace: stackrox
        remediationAction: enforce
        severity: medium
  - ignorePending: true
    objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle-expired3
      spec:
        evaluationInterval:
          compliant: 1m
          noncompliant: 45s
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: v1
            kind: Secret
            metadata:
              name: admission-control-tls
              namespace: stackrox
        remediationAction: enforce
        severity: medium
  - ignorePending: true
    objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle-expired4
      spec:
        evaluationInterval:
          compliant: 1m
          noncompliant: 45s
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: imageregistry.operator.openshift.io/v1
            kind: Config
            metadata:
              name: cluster
            spec:
              managementState: Managed
              storage:
                emptyDir: {}
            status:
              conditions:
              - status: "True"
                type: Available
        remediationAction: enforce
        severity: medium
  - ignorePending: true
    objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-central-ca-bundle-expired5
      spec:
        evaluationInterval:
          compliant: 1m
          noncompliant: 45s
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: batch/v1
            kind: Job
            metadata:
              annotations:
                argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
                argocd.argoproj.io/sync-wave: "2"
              labels:
                init-bundle: central
              name: create-cluster-init-bundle-v2
              namespace: stackrox
            spec:
              template:
                metadata:
                  annotations:
                    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true
                  labels:
                    init-bundle: central
                spec:
                  containers:
                  - command:
                    - /bin/bash
                    - -c
                    - "#!/usr/bin/env bash\nif kubectl get secret/sensor-tls &> /dev/null;
                      then\n  echo \"cluster-init bundle has already been configured,
                      doing nothing\"\n  exit 0\nelse\n\n  # Wait for central to be
                      ready\n  attempt_counter=0\n  max_attempts=20\n  echo \"Waiting
                      for central to be available...\"\n  until $(curl -k --output
                      /dev/null --silent --head --fail https://central); do\n      if
                      [ ${attempt_counter} -eq ${max_attempts} ];then\n        echo
                      \"Max attempts reached\"\n        exit 1\n      fi\n\n      printf
                      '.'\n      attempt_counter=$(($attempt_counter+1))\n      echo
                      \"Made attempt $attempt_counter, waiting...\"\n      sleep 5\n
                      \ done\n\n  # attempt to create init-bundle\n  # on failure
                      attempt to delete the bundle\n  attempt_counter=0\n  max_attempts=5\n
                      \ echo \"Configuring cluster-init bundle\"\n  \n  # set the
                      bundle name to include todays date\n  bundle_name=local-cluster-$(date
                      '+%Y%m%d')\n  export DATA={\\\"name\\\":\\\"$bundle_name\\\"}\n
                      \ until (curl -k -o /tmp/bundle.json -X POST -u \"admin:$PASSWORD\"
                      -H \"Content-Type: application/json\" --data $DATA --fail https://central/v1/cluster-init/init-bundles);
                      do\n      if [ ${attempt_counter} -eq ${max_attempts} ];then\n
                      \       echo \"Max attempts to create bundle reached\"\n        exit
                      1\n      fi\n\n      echo \"Check to see if there is an existing
                      bundle that can be revoked\"\n      curl -o /tmp/find_bundle.json
                      \ -k -X GET -u \"admin:$PASSWORD\" -H \"Content-Type: application/json\"
                      https://central/v1/cluster-init/init-bundles\n      bundle_id=$(cat
                      /tmp/find_bundle.json | python -c \"import sys, json; result
                      = [x for x in json.load(sys.stdin)[\\\"items\\\"] if x[\\\"name\\\"]==\\\"$bundle_name\\\"];
                      print(result[0][\\\"id\\\"])\")\n\n      echo \"-------------------------\"\n
                      \     echo \"bundle name is $bundle_name bundle id $bundle_id\"\n
                      \     echo \"-------------------------\"\n\n      if [ \"${bundle_id}\"
                      != \"\" ];then\n      echo \"executing revoke command\"\n        export
                      REVOKE=\"{\\\"ids\\\":[\\\"$bundle_id\\\"],\\\"confirmImpactedClustersIds\\\":[]}\"\n
                      \       curl -k -X PATCH -u \"admin:$PASSWORD\" -H \"Content-Type:
                      application/json\" --data $REVOKE https://central/v1/cluster-init/init-bundles/revoke\n
                      \     fi\n\n      printf '.'\n      attempt_counter=$(($attempt_counter+1))\n
                      \     echo \"Made create bundle attempt $attempt_counter, waiting...\"\n
                      \     sleep 5\n  done\n\n  echo \"Bundle received\"\n\n  if
                      [[ \"$OSTYPE\" == \"linux-gnu\"* ]]; then\n      BASE='base64
                      -w 0'\n  elif [[ \"$OSTYPE\" == \"darwin\"* ]]; then\n      BASE='base64'\n
                      \ fi\n\n  echo \"Applying bundle\"\n  # No jq in container,
                      python to the rescue\n  cat /tmp/bundle.json | python3 -c \"import
                      sys, json; print(json.load(sys.stdin)['kubectlBundle'])\" |
                      ${BASE} -d | oc apply -f -\n  ACS_HOST=\"$(oc get route central
                      -o custom-columns=HOST:.spec.host --no-headers):443\"\n  oc
                      patch secret sensor-tls --type='json' -p=\"[{\\\"op\\\" : \\\"add\\\",
                      \\\"path\\\" : \\\"/data/acs-host\\\", \\\"value\\\" : \\\"$(echo
                      $ACS_HOST | ${BASE})\\\"}]\"\n  echo \"ACS Cluster init bundle
                      generated and applied\"\nfi\n"
                    env:
                    - name: PASSWORD
                      valueFrom:
                        secretKeyRef:
                          key: password
                          name: central-htpasswd
                    image: image-registry.openshift-image-registry.svc:5000/openshift/cli:latest
                    imagePullPolicy: Always
                    name: create-cluster-init-bundle
                  dnsPolicy: ClusterFirst
                  restartPolicy: Never
                  serviceAccount: create-cluster-init
                  serviceAccountName: create-cluster-init
                  terminationGracePeriodSeconds: 30
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SC System and Communications Protection
    policy.open-cluster-management.io/controls: SC-1 Policy and Procedures
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: acs-enf-operator-central
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: odf-inf-status
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-operator-central
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: stackrox
        - complianceType: musthave
          objectDefinition:
            apiVersion: platform.stackrox.io/v1alpha1
            kind: Central
            metadata:
              name: stackrox-central-services
              namespace: stackrox
            spec:
              central:
                db:
                  persistence:
                    persistentVolumeClaim:
                      claimName: central-db
                      size: 10Gi
                      storageClassName: ocs-storagecluster-ceph-rbd
                  resources:
                    requests:
                      cpu: 2
                      memory: 4Gi
                exposure:
                  loadBalancer:
                    enabled: false
                    port: 443
                  nodePort:
                    enabled: false
                  route:
                    enabled: true
              egress:
                connectivityPolicy: Offline
              scanner:
                analyzer:
                  scaling:
                    autoScaling: Enabled
                    maxReplicas: 5
                    minReplicas: 1
                    replicas: 1
                scannerComponent: Enabled
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-5 Security Alerts Advisories and
      Directives
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: acs-enf-sync-resources
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: acs-enf-central-ca-bundle
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-sync-resources
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: platform.stackrox.io/v1alpha1
            kind: SecuredCluster
            metadata:
              name: stackrox-secured-cluster-services
              namespace: stackrox
            spec:
              admissionControl:
                listenOnCreates: false
                listenOnEvents: true
                listenOnUpdates: false
              auditLogs:
                collection: Auto
              centralEndpoint: |
                {{ fromSecret "stackrox" "sensor-tls" "acs-host" | base64dec }}
              clusterName: |
                {{ fromSecret "open-cluster-management-agent" "hub-kubeconfig-secret" "cluster-name" | base64dec }}
              perNode:
                collector:
                  collection: CORE_BPF
                  imageFlavor: Regular
                taintToleration: TolerateTaints
              scanner:
                scannerComponent: Disabled
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-sync-resources2
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              admission-control-cert.pem: '{{ fromSecret "stackrox" "admission-control-tls"
                "admission-control-cert.pem" }}'
              admission-control-key.pem: '{{ fromSecret "stackrox" "admission-control-tls"
                "admission-control-key.pem" }}'
              ca.pem: '{{ fromSecret "stackrox" "admission-control-tls" "ca.pem" }}'
            kind: Secret
            metadata:
              labels:
                certificate_key_name: admission-control-cert.pem
              name: admission-control-tls
              namespace: policies
            type: Opaque
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-sync-resources3
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              ca.pem: '{{ fromSecret "stackrox" "collector-tls" "ca.pem" }}'
              collector-cert.pem: '{{ fromSecret "stackrox" "collector-tls" "collector-cert.pem"
                }}'
              collector-key.pem: '{{ fromSecret "stackrox" "collector-tls" "collector-key.pem"
                }}'
            kind: Secret
            metadata:
              labels:
                certificate_key_name: collector-cert.pem
              name: collector-tls
              namespace: policies
            type: Opaque
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-sync-resources4
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              acs-host: '{{ fromSecret "stackrox" "sensor-tls" "acs-host" }}'
              ca.pem: '{{ fromSecret "stackrox" "sensor-tls" "ca.pem" }}'
              sensor-cert.pem: '{{ fromSecret "stackrox" "sensor-tls" "sensor-cert.pem"
                }}'
              sensor-key.pem: '{{ fromSecret "stackrox" "sensor-tls" "sensor-key.pem"
                }}'
            kind: Secret
            metadata:
              labels:
                certificate_key_name: sensor-cert.pem
              name: sensor-tls
              namespace: policies
            type: Opaque
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-enf-sync-resources5
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: console.openshift.io/v1
            kind: ConsoleLink
            metadata:
              name: acs
            spec:
              applicationMenu:
                section: Red Hat applications
              href: https://{{ (lookup "route.openshift.io/v1" "Route" "stackrox"
                "central").spec.host }}
              location: ApplicationMenu
              text: Red Hat Advanced Cluster Security for Kubernetes
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-5 Security Alerts Advisories and
      Directives
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: acs-inf-central-status
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: acs-enf-operator-central
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-inf-central-status
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: central
              namespace: stackrox
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: central-db
              namespace: stackrox
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: scanner-db
              namespace: stackrox
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: scanner
              namespace: stackrox
            status:
              conditions:
              - status: "True"
                type: Available
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SC System and Communications Protection
    policy.open-cluster-management.io/controls: SC-8 Transmission Confidentiality
      and Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: acs-inf-monitor-certs
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: acs-enf-central-ca-bundle
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: CertificatePolicy
      metadata:
        name: acs-bundle-certificates
      spec:
        minimumDuration: 720h
        namespaceSelector:
          include:
          - policies
        remediationAction: inform
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-inf-monitor-certs
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Secret
            metadata:
              name: sensor-tls
              namespace: stackrox
        remediationAction: inform
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-inf-monitor-certs2
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Secret
            metadata:
              name: collector-tls
              namespace: stackrox
        remediationAction: inform
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: acs-inf-monitor-certs3
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Secret
            metadata:
              name: admission-control-tls
              namespace: stackrox
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-5 Security Alerts Advisories and
      Directives
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: advanced-enf-managed-cluster-security
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: advanced-enf-managed-cluster-security
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: stackrox
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: advanced-enf-managed-cluster-security2
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              admission-control-cert.pem: '{{hub fromSecret "policies" "admission-control-tls"
                "admission-control-cert.pem" hub}}'
              admission-control-key.pem: '{{hub fromSecret "policies" "admission-control-tls"
                "admission-control-key.pem" hub}}'
              ca.pem: '{{hub fromSecret "policies" "admission-control-tls" "ca.pem"
                hub}}'
            kind: Secret
            metadata:
              name: admission-control-tls
              namespace: stackrox
            type: Opaque
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: advanced-enf-managed-cluster-security3
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              ca.pem: '{{hub fromSecret "policies" "collector-tls" "ca.pem" hub}}'
              collector-cert.pem: '{{hub fromSecret "policies" "collector-tls" "collector-cert.pem"
                hub}}'
              collector-key.pem: '{{hub fromSecret "policies" "collector-tls" "collector-key.pem"
                hub}}'
            kind: Secret
            metadata:
              name: collector-tls
              namespace: stackrox
            type: Opaque
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: advanced-enf-managed-cluster-security4
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              acs-host: '{{hub fromSecret "policies" "sensor-tls" "acs-host" hub}}'
              ca.pem: '{{hub fromSecret "policies" "sensor-tls" "ca.pem" hub}}'
              sensor-cert.pem: '{{hub fromSecret "policies" "sensor-tls" "sensor-cert.pem"
                hub}}'
              sensor-key.pem: '{{hub fromSecret "policies" "sensor-tls" "sensor-key.pem"
                hub}}'
            kind: Secret
            metadata:
              name: sensor-tls
              namespace: stackrox
            type: Opaque
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: advanced-enf-managed-cluster-security5
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: platform.stackrox.io/v1alpha1
            kind: SecuredCluster
            metadata:
              name: stackrox-secured-cluster-services
              namespace: stackrox
            spec:
              admissionControl:
                listenOnCreates: false
                listenOnEvents: true
                listenOnUpdates: false
                replicas: 1
              auditLogs:
                collection: Auto
              centralEndpoint: |
                {{ fromSecret "stackrox" "sensor-tls" "acs-host" | base64dec }}
              clusterName: |
                {{ fromSecret "open-cluster-management-agent" "hub-kubeconfig-secret" "cluster-name" | base64dec }}
              perNode:
                collector:
                  collection: CORE_BPF
                  imageFlavor: Regular
                taintToleration: TolerateTaints
              scanner:
                analyzer:
                  scaling:
                    minReplicas: 1
                    replicas: 1
              sensor:
                resources:
                  requests:
                    cpu: 500m
                    memory: 1Gi
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-5 Security Alerts Advisories and
      Directives
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: advanced-inf-managed-cluster-status
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: advanced-inf-managed-cluster-status
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: sensor
              namespace: stackrox
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: DaemonSet
            metadata:
              name: collector
              namespace: stackrox
            status:
              numberMisscheduled: 0
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: admission-control
              namespace: stackrox
            status:
              conditions:
              - status: "True"
                type: Available
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: all-enf-operators-install
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: all-enf-operators-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-logging
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-logging
              namespace: openshift-logging
            spec:
              targetNamespaces:
              - openshift-logging
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: cluster-logging
              namespace: openshift-logging
            spec:
              name: cluster-logging
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: stackrox
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: rhacs-operator
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: rhacs-operator
              namespace: rhacs-operator
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: rhacs-operator
              namespace: rhacs-operator
            spec:
              name: rhacs-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-compliance
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-compliance
              namespace: openshift-compliance
            spec:
              targetNamespaces:
              - openshift-compliance
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: compliance-operator
              namespace: openshift-compliance
            spec:
              name: compliance-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: container-security-operator
              namespace: openshift-operators
            spec:
              name: container-security-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-ingress-node-firewall
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-ingress-node-firewall
              namespace: openshift-ingress-node-firewall
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: ingress-node-firewall
              namespace: openshift-ingress-node-firewall
            spec:
              name: ingress-node-firewall
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-nmstate
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-nmstate
              namespace: openshift-nmstate
            spec:
              targetNamespaces:
              - openshift-nmstate
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: kubernetes-nmstate-operator
              namespace: openshift-nmstate
            spec:
              name: kubernetes-nmstate-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-workload-availability
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-workload-availability
              namespace: openshift-workload-availability
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: node-healthcheck-operator
              namespace: openshift-workload-availability
            spec:
              name: node-healthcheck-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: self-node-remediation
              namespace: openshift-workload-availability
            spec:
              name: self-node-remediation
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: metallb-system
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: metallb-system
              namespace: metallb-system
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: metallb-operator
              namespace: metallb-system
            spec:
              name: metallb-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-adp
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-adp
              namespace: openshift-adp
            spec:
              targetNamespaces:
              - openshift-adp
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: redhat-oadp-operator
              namespace: openshift-adp
            spec:
              name: redhat-oadp-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: create-enf-router-bundle
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: proxy-sync-hub
      spec:
        object-templates-raw: |
          {{- if ne (lookup "v1" "ConfigMap" "openshift-config" "router-bundle").kind "ConfigMap" -}}
          - complianceType: musthave
            objectDefinition:
              apiVersion: v1
              data:
                ca-bundle.crt: |
                  {{ ( fromSecret "openshift-ingress-operator" "router-ca" "tls.crt" ) | base64dec | autoindent }}
              kind: ConfigMap
              metadata:
                name: router-bundle
                namespace: openshift-config
          {{- end -}}
        remediationAction: enforce
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: create-enf-router-bundle
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              ca-bundle.crt: |
                {{ ( fromConfigMap "openshift-config" "router-bundle" "ca-bundle.crt" ) | autoindent }}
            kind: ConfigMap
            metadata:
              name: router-bundle
              namespace: policies
        - complianceType: musthave
          objectDefinition:
            apiVersion: config.openshift.io/v1
            kind: Proxy
            metadata:
              name: cluster
            spec:
              trustedCA:
                name: router-bundle
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: cs-enf-redhat-operator-update
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: cv-inf-check
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: cs-redhat-operator-update
      spec:
        object-templates-raw: |
          {{- $cs := lookup "operators.coreos.com/v1alpha1" "CatalogSource" "openshift-marketplace" "cs-redhat-operator-index" }}
          - complianceType: musthave
            objectDefinition:
              apiVersion: operators.coreos.com/v1alpha1
              kind: CatalogSource
              metadata:
                name: {{ $cs.metadata.name }}
                namespace: {{ $cs.metadata.namespace }}
              spec:
                image: {{ ( (cat (split ":v4." $cs.spec.image)._0 ":v4." (split "." (lookup "config.openshift.io/v1" "ClusterVersion" "" "version").status.desired.version)._1) | replace " " "" ) }}
                sourceType: grpc
        remediationAction: enforce
        severity: high
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: csv-inf-check
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: csv-check
      spec:
        object-templates-raw: |
          {{- range $sub := (lookup "operators.coreos.com/v1alpha1" "Subscription" "" "!policies.ignore").items }}
          {{- $pm := lookup "packages.operators.coreos.com/v1" "PackageManifest" "openshift-marketplace" $sub.metadata.name ( (cat "catalog=" $sub.spec.source ) | replace " " "" ) }}
          {{- range $ch := $pm.status.channels }}
          {{- if (eq $ch.name $pm.status.defaultChannel) }}
          - complianceType: musthave
            objectDefinition:
              apiVersion: operators.coreos.com/v1alpha1
              kind: ClusterServiceVersion
              metadata:
                name: {{ $ch.currentCSV }}
                namespace: {{ $sub.metadata.namespace }}
              status:
                phase: Succeeded
          {{- end }}
          {{- end }}
          {{- end }}
        remediationAction: inform
        severity: high
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: cv-inf-check
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: cv-inf-check
      spec:
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: config.openshift.io/v1
            kind: ClusterOperator
            status:
              conditions:
              - status: "False"
                type: Available
        remediationAction: inform
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: cv-inf-check2
      spec:
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: config.openshift.io/v1
            kind: ClusterOperator
            status:
              conditions:
              - status: "True"
                type: Degraded
        remediationAction: inform
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: cv-inf-check3
      spec:
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: machineconfiguration.openshift.io/v1
            kind: MachineConfigPool
            status:
              conditions:
              - status: "False"
                type: Updated
        remediationAction: inform
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: cv-inf-check4
      spec:
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: machineconfiguration.openshift.io/v1
            kind: MachineConfigPool
            status:
              conditions:
              - status: "True"
                type: Degraded
        remediationAction: inform
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: cv-inf-check5
      spec:
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: config.openshift.io/v1
            kind: ClusterVersion
            status:
              conditions:
              - status: "False"
                type: Available
        remediationAction: inform
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: cv-inf-check6
      spec:
        object-templates:
        - complianceType: mustnothave
          objectDefinition:
            apiVersion: config.openshift.io/v1
            kind: ClusterVersion
            status:
              conditions:
              - status: "True"
                type: Progressing
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: hub-enf-operators-install
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: hub-enf-operators-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-local-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-local-storage
              namespace: openshift-local-storage
            spec:
              targetNamespaces:
              - openshift-local-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: local-storage-operator
              namespace: openshift-local-storage
            spec:
              config:
                nodeSelector:
                  cluster.ocs.openshift.io/openshift-storage: ""
                tolerations:
                - effect: NoSchedule
                  key: node.ocs.openshift.io/storage
                  operator: Equal
                  value: "true"
              name: local-storage-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-storage
              namespace: openshift-storage
            spec:
              targetNamespaces:
              - openshift-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: odf-operator
              namespace: openshift-storage
            spec:
              config:
                nodeSelector:
                  cluster.ocs.openshift.io/openshift-storage: ""
                tolerations:
                - effect: NoSchedule
                  key: node.ocs.openshift.io/storage
                  operator: Equal
                  value: "true"
              name: odf-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: quay-enterprise
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: quay-enterprise
              namespace: quay-enterprise
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: quay-operator
              namespace: quay-enterprise
            spec:
              config:
                nodeSelector:
                  node-role.kubernetes.io/quay: ""
                tolerations:
                - effect: NoSchedule
                  key: node-role.kubernetes.io/infra
                  operator: Exists
              name: quay-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: servicemeshoperator
              namespace: openshift-operators
            spec:
              config:
                nodeSelector:
                  node-role.kubernetes.io/acm: ""
                tolerations:
                - effect: NoSchedule
                  key: node-role.kubernetes.io/infra
                  operator: Exists
              name: servicemeshoperator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: kiali-ossm
              namespace: openshift-operators
            spec:
              config:
                nodeSelector:
                  node-role.kubernetes.io/acm: ""
                tolerations:
                - effect: NoSchedule
                  key: node-role.kubernetes.io/infra
                  operator: Exists
              name: kiali-ossm
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-tempo-operator
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-tempo-operator
              namespace: openshift-tempo-operator
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: tempo-product
              namespace: openshift-tempo-operator
            spec:
              config:
                nodeSelector:
                  node-role.kubernetes.io/acm: ""
                tolerations:
                - effect: NoSchedule
                  key: node-role.kubernetes.io/infra
                  operator: Exists
              name: tempo-product
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-gitops-operator
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-gitops-operator
              namespace: openshift-gitops-operator
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: openshift-gitops-operator
              namespace: openshift-gitops-operator
            spec:
              config:
                nodeSelector:
                  node-role.kubernetes.io/acm: ""
                tolerations:
                - effect: NoSchedule
                  key: node-role.kubernetes.io/infra
                  operator: Exists
              name: openshift-gitops-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-update-service
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1
            kind: OperatorGroup
            metadata:
              name: openshift-update-service
              namespace: openshift-update-service
            spec:
              targetNamespaces:
              - openshift-update-service
        - complianceType: musthave
          objectDefinition:
            apiVersion: operators.coreos.com/v1alpha1
            kind: Subscription
            metadata:
              name: cincinnati-operator
              namespace: openshift-update-service
            spec:
              config:
                nodeSelector:
                  node-role.kubernetes.io/acm: ""
                tolerations:
                - effect: NoSchedule
                  key: node-role.kubernetes.io/infra
                  operator: Exists
              name: cincinnati-operator
              source: cs-redhat-operator-index
              sourceNamespace: openshift-marketplace
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: CA Assessment Authorization and
      Monitoring
    policy.open-cluster-management.io/controls: CA-7 Continuous Monitoring
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: observability-enf-operator
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: observability-enf-storage
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: thanos-secret
      spec:
        object-templates-raw: "{{- /* read the bucket data and noobaa endpoint access
          data */ -}}\n{{- $objBucket := (lookup \"objectbucket.io/v1alpha1\" \"ObjectBucket\"
          \"\" \"obc-openshift-storage-obc-observability\") }}\n{{- $awsAccess :=
          (lookup \"v1\" \"Secret\" \"openshift-storage\" \"obc-observability\") }}\n{{-
          /* create the thanos config file as a template */ -}}\n{{- $thanosConfig
          := `\ntype: s3\nconfig:\n  bucket: %[1]s\n  endpoint: %[2]s\n  insecure:
          true\n  access_key: %[3]s\n  secret_key: %[4]s`\n}}\n\n{{- /* create the
          secret using the thanos configuration template created above. */ -}}\n-
          complianceType: mustonlyhave\n  objectDefinition:\n    apiVersion: v1\n
          \   kind: Secret\n    metadata:\n      name: thanos-object-storage\n      namespace:
          open-cluster-management-observability\n    type: Opaque\n    data:\n      thanos.yaml:
          {{ (printf $thanosConfig $objBucket.spec.endpoint.bucketName \n                                            $objBucket.spec.endpoint.bucketHost
          \n                                            ($awsAccess.data.AWS_ACCESS_KEY_ID
          | base64dec) \n                                            ($awsAccess.data.AWS_SECRET_ACCESS_KEY
          | base64dec)\n                      ) | base64enc }}\n"
        remediationAction: enforce
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: observability-enf-operator
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              .dockerconfigjson: '{{- if eq (lookup "v1" "Secret" "open-cluster-management"
                "multiclusterhub-operator-pull-secret").kind "Secret" -}} {{- fromSecret
                "open-cluster-management" "multiclusterhub-operator-pull-secret" ".dockerconfigjson"
                -}} {{- else -}} {{- fromSecret "openshift-config" "pull-secret" ".dockerconfigjson"
                -}} {{- end -}}'
            kind: Secret
            metadata:
              name: multiclusterhub-operator-pull-secret
              namespace: open-cluster-management-observability
            type: kubernetes.io/dockerconfigjson
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: observability-enf-operator2
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: observability.open-cluster-management.io/v1beta2
            kind: MultiClusterObservability
            metadata:
              name: observability
            spec:
              advanced:
                alertmanager:
                  replicas: 1
                grafana:
                  replicas: 1
                observatoriumAPI:
                  replicas: 1
                query:
                  replicas: 1
                queryFrontend:
                  replicas: 1
                queryFrontendMemcached:
                  replicas: 1
                rbacQueryProxy:
                  replicas: 1
                receive:
                  replicas: 1
                rule:
                  replicas: 1
                store:
                  replicas: 1
                storeMemcached:
                  replicas: 1
              nodeSelector:
                node-role.kubernetes.io/acm: ""
              observabilityAddonSpec: {}
              storageConfig:
                metricObjectStorage:
                  key: thanos.yaml
                  name: thanos-object-storage
                storageClass: ocs-storagecluster-ceph-rbd
              tolerations:
              - effect: NoSchedule
                key: node-role.kubernetes.io/infra
                operator: Exists
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: observability-enf-operator3
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: console.openshift.io/v1
            kind: ConsoleLink
            metadata:
              name: observability
            spec:
              applicationMenu:
                section: Red Hat applications
              href: https://{{ (lookup "route.openshift.io/v1" "Route" "open-cluster-management-observability"
                "grafana").spec.host }}
              location: ApplicationMenu
              text: Red Hat Advanced Cluster Management Observability
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: CA Assessment Authorization and
      Monitoring
    policy.open-cluster-management.io/controls: CA-7 Continuous Monitoring
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: observability-enf-storage
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: odf-inf-status
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: observability-enf-storage
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: objectbucket.io/v1alpha1
            kind: ObjectBucketClaim
            metadata:
              name: obc-observability
              namespace: openshift-storage
            spec:
              generateBucketName: obc-observability-bucket
              storageClassName: ocs-storagecluster-ceph-rgw
            status:
              phase: Bound
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: odf-enf
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: openshift-storage-subscripions
      spec:
        object-templates-raw: |
          {{- range $sub := (lookup "operators.coreos.com/v1alpha1" "Subscription" "openshift-storage" "").items }}
          - complianceType: musthave
            objectDefinition:
              apiVersion: operators.coreos.com/v1alpha1
              kind: Subscription
              metadata:
                name: {{ $sub.metadata.name }}
                namespace: openshift-storage
              spec:
                config:
                  nodeSelector:
                    cluster.ocs.openshift.io/openshift-storage: ""
                  tolerations:
                  - effect: NoSchedule
                    operator: Equal
                    key: node.ocs.openshift.io/storage
                    value: "true"
          {{- end }}
        remediationAction: enforce
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: odf-enf
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: local.storage.openshift.io/v1
            kind: LocalVolume
            metadata:
              name: local-block-odf
              namespace: openshift-local-storage
            spec:
              nodeSelector:
                nodeSelectorTerms:
                - matchExpressions:
                  - key: cluster.ocs.openshift.io/openshift-storage
                    operator: Exists
              storageClassDevices:
              - devicePaths:
                - /dev/disk/by-path/pci-0000:05:00.0
                storageClassName: localblock-odf
                volumeMode: Block
              tolerations:
              - effect: NoSchedule
                key: node.ocs.openshift.io/storage
                operator: Equal
                value: "true"
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: operator.openshift.io/v1
            kind: Console
            metadata:
              name: cluster
            spec:
              plugins:
              - odf-console
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: odf-enf-cluster
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: odf-enf
    namespace: policies
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: odf-inf-volume
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: odf-enf-cluster
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: ocs.openshift.io/v1
            kind: StorageCluster
            metadata:
              annotations:
                uninstall.ocs.openshift.io/cleanup-policy: delete
                uninstall.ocs.openshift.io/mode: graceful
              name: ocs-storagecluster
              namespace: openshift-storage
            spec:
              flexibleScaling: true
              monDataDirHostPath: /var/lib/rook
              multiCloudGateway:
                reconcileStrategy: ignore
              placement:
                all:
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
                mds:
                  podAntiAffinity:
                    preferredDuringSchedulingIgnoredDuringExecution:
                    - podAffinityTerm:
                        labelSelector:
                          matchLabels:
                            app: rook-ceph-mds
                        topologyKey: kubernetes.io/hostname
                      weight: 49
                    - podAffinityTerm:
                        labelSelector:
                          matchLabels:
                            app: rook-ceph-mgr
                        topologyKey: kubernetes.io/hostname
                      weight: 48
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
                'noobaa-core:':
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
                rgw:
                  podAntiAffinity:
                    preferredDuringSchedulingIgnoredDuringExecution:
                    - podAffinityTerm:
                        labelSelector:
                          matchLabels:
                            app: rook-ceph-mds
                        topologyKey: kubernetes.io/hostname
                      weight: 47
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
              resources:
                mds:
                  requests:
                    cpu: 500m
                    memory: 1Gi
                mgr:
                  requests:
                    cpu: 500m
                    memory: 1Gi
                mon:
                  requests:
                    cpu: 500m
                    memory: 1Gi
                rgw:
                  requests:
                    cpu: 500m
                    memory: 1Gi
              storageDeviceSets:
              - count: 3
                dataPVCTemplate:
                  spec:
                    accessModes:
                    - ReadWriteOnce
                    resources:
                      requests:
                        storage: 1Gi
                    storageClassName: localblock-odf
                    volumeMode: Block
                name: ocs-deviceset-localblock-odf
                replica: 1
                resources:
                  requests:
                    cpu: "1"
                    memory: 1536Mi
        - complianceType: musthave
          objectDefinition:
            apiVersion: storage.k8s.io/v1
            kind: StorageClass
            metadata:
              annotations:
                storageclass.kubernetes.io/is-default-class: "true"
              name: ocs-storagecluster-ceph-rbd
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              CSI_PLUGIN_TOLERATIONS: |
                - key: node.ocs.openshift.io/storage
                  operator: Exists
                  effect: NoSchedule
              CSI_PROVISIONER_NODE_AFFINITY: cluster.ocs.openshift.io/openshift-storage=
              CSI_PROVISIONER_TOLERATIONS: |
                - effect: NoSchedule
                  operator: Exists
                  key: node.ocs.openshift.io/storage
            kind: ConfigMap
            metadata:
              name: rook-ceph-operator-config
              namespace: openshift-storage
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: odf-inf-status
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: odf-enf
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: odf-inf-status
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: ocs-operator
              namespace: openshift-storage
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: rook-ceph-rgw-ocs-storagecluster-cephobjectstore-a
              namespace: openshift-storage
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: ocs.openshift.io/v1
            kind: StorageCluster
            metadata:
              name: ocs-storagecluster
              namespace: openshift-storage
            status:
              phase: Ready
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: odf-inf-volume
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: localblock-odf-persistent-volume
      spec:
        object-templates-raw: |
          {{- range $nd := (lookup "v1" "Node" "" "" "cluster.ocs.openshift.io/openshift-storage=").items }}
          {{- range $pv := (lookup "v1" "PersistentVolume" "" "" ( (cat "kubernetes.io/hostname=" $nd.metadata.name ", storage.openshift.com/local-volume-owner-name=localblock-odf") | replace " " "")).items }}
          - complianceType: musthave
            objectDefinition:
              apiVersion: v1
              kind: PersistentVolume
              metadata:
                name: {{ $pv.metadata.name }}
              spec:
                accessModes:
                - ReadWriteOnce
                storageClassName: localblock-odf
                volumeMode: Block
                nodeAffinity:
                  required:
                    nodeSelectorTerms:
                    - matchExpressions:
                      - key: kubernetes.io/hostname
                        operator: In
                        values:
                        - {{ $nd.metadata.name }}
              status:
                phase: Available
          {{- end }}
          {{- end }}
        remediationAction: inform
        severity: high
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: quay-enf-config
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: quay-enf-install
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: quay-enf-config
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              host: '{{ (lookup "route.openshift.io/v1" "Route" "quay-enterprise"
                "quay-registry-quay" ).spec.host }}'
            kind: ConfigMap
            metadata:
              name: quay-config
              namespace: policies
        - complianceType: musthave
          objectDefinition:
            apiVersion: console.openshift.io/v1
            kind: ConsoleLink
            metadata:
              name: quay
            spec:
              applicationMenu:
                section: Red Hat applications
              href: https://{{ (lookup "route.openshift.io/v1" "Route" "quay-enterprise"
                "quay-registry-quay" ).spec.host }}
              location: ApplicationMenu
              text: Red Hat Quay Enterprise Registry
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: quay-enf-install
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: quay-enf-storage
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: init-config-bundle-secret
      spec:
        object-templates-raw: |
          {{- /* read the bucket data and endpoint access data */ -}}
          {{- $objBucket := (lookup "objectbucket.io/v1alpha1" "ObjectBucket" "" "obc-quay-enterprise-registry-quay") }}
          {{- $awsAccess := (lookup "v1" "Secret" "quay-enterprise" "registry-quay") }}
          {{- /* create the quay config file as a template */ -}}
          {{- $quayConfig := `
          DISTRIBUTED_STORAGE_CONFIG:
            default:
              - RadosGWStorage
              - access_key: %[1]s
                bucket_name: %[2]s
                hostname: rook-ceph-rgw-ocs-storagecluster-cephobjectstore.openshift-storage.svc
                is_secure: true
                port: 443
                secret_key: %[3]s
                storage_path: /datastorage/registry-quay
          DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
          DISTRIBUTED_STORAGE_PREFERENCE:
            - default
          FEATURE_USER_INITIALIZE: true
          BROWSER_API_CALLS_XHR_ONLY: false
          SUPER_USERS:
          - quayadmin
          FEATURE_USER_CREATION: true
          FEATURE_SUPERUSERS_FULL_ACCESS: true`
          }}

          {{- /* create the secret using the quay configuration template created above. */ -}}
          - complianceType: mustonlyhave
            objectDefinition:
              apiVersion: v1
              kind: Secret
              metadata:
                name: init-config-bundle-secret
                namespace: quay-enterprise
              type: Opaque
              data:
                config.yaml: {{ (printf $quayConfig ($awsAccess.data.AWS_ACCESS_KEY_ID | base64dec) $objBucket.spec.endpoint.bucketName ($awsAccess.data.AWS_SECRET_ACCESS_KEY | base64dec)) | base64enc }}
        remediationAction: enforce
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: quay-enf-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              config.yaml: QVVUSEVOVElDQVRJT05fVFlQRTogT0lEQwpCQU5LX0xPR0lOX0NPTkZJRzoKICBDTElFTlRfSUQ6IHF1YXktZW50ZXJwcmlzZQogIENMSUVOVF9TRUNSRVQ6IHpaVnRGMERuTXpWNWpvR0FZOVBZZXRCeHVqUVNjV3NMCiAgT0lEQ19TRVJWRVI6IGh0dHBzOi8va2V5Y2xvYWsucGFhcy53b29yaWZnLmNvbTo4MTQzL3JlYWxtcy93b29yaS1yZWFsbS8KICBTRVJWSUNFX05BTUU6IFdvb3JpQmFuayBTU08KICBQUkVGRVJSRURfR1JPVVBfQ0xBSU1fTkFNRTogcXVheS1ncm91cAogIExPR0lOX1NDT1BFUzogWyAnb3BlbmlkJyBdCiAgT0lEQ19ESVNBQkxFX1VTRVJfRU5EUE9JTlQ6IGZhbHNlCkNBUkRfTE9HSU5fQ09ORklHOgogIENMSUVOVF9JRDogcXVheS1lbnRlcnByaXNlCiAgQ0xJRU5UX1NFQ1JFVDogUXBJU0w1Qkt2QWkwQmdtYzNJOVRUZWgydDBzQU9HOW0KICBPSURDX1NFUlZFUjogaHR0cHM6Ly9rZXljbG9hay5wYWFzLndvb3JpZmcuY29tOjgxNDMvcmVhbG1zL2NhcmQtcmVhbG0vCiAgU0VSVklDRV9OQU1FOiBXb29yaUNhcmQgU1NPCiAgUFJFRkVSUkVEX0dST1VQX0NMQUlNX05BTUU6IHF1YXktZ3JvdXAKICBMT0dJTl9TQ09QRVM6IFsgJ29wZW5pZCcgXQogIE9JRENfRElTQUJMRV9VU0VSX0VORFBPSU5UOiBmYWxzZQpGRUFUVVJFX1RFQU1fU1lOQ0lORzogdHJ1ZQpGRUFUVVJFX05PTlNVUEVSVVNFUl9URUFNX1NZTkNJTkdfU0VUVVA6IHRydWUKRkVBVFVSRV9VSV9WMjogdHJ1ZQpERUZBVUxUX1RBR19FWFBJUkFUSU9OOiAydwpQUkVGRVJSRURfVVJMX1NDSEVNRTogaHR0cApTRVJWRVJfSE9TVE5BTUU6IHJlZ2lzdHJ5LmFwcHMucGFhcy53b29yaWZnLmNvbQpTRVRVUF9DT01QTEVURTogdHJ1ZQpTVVBFUl9VU0VSUzoKICAtIHF1YXlhZG1pbgpGRUFUVVJFX1VTRVJfQ1JFQVRJT046IHRydWUKRkVBVFVSRV9VU0VSX0lOSVRJQUxJWkU6IGZhbHNlCkZFQVRVUkVfU1VQRVJVU0VSU19PUkdfQ1JFQVRJT05fT05MWTogdHJ1ZQpGRUFUVVJFX1NVUEVSVVNFUlNfRlVMTF9BQ0NFU1M6IHRydWUKRkVBVFVSRV9SRVNUUklDVEVEX1VTRVJTOiBmYWxzZSAKUkVTVFJJQ1RFRF9VU0VSU19XSElURUxJU1Q6CiAgLSBxdWF5YWRtaW4KQlJPV1NFUl9BUElfQ0FMTFNfWEhSX09OTFk6IGZhbHNlClRBR19FWFBJUkFUSU9OX09QVElPTlM6CiAgLSAxZAogIC0gMXcKICAtIDJ3CiAgLSA0dw==
            kind: Secret
            metadata:
              name: quay-config-bundle
              namespace: quay-enterprise
            type: Opaque
        - complianceType: musthave
          objectDefinition:
            apiVersion: quay.redhat.com/v1
            kind: QuayRegistry
            metadata:
              name: quay-registry
              namespace: quay-enterprise
            spec:
              components:
              - kind: clair
                managed: false
              - kind: clairpostgres
                managed: false
              - kind: mirror
                managed: false
              - kind: horizontalpodautoscaler
                managed: false
              - kind: objectstorage
                managed: false
              - kind: quay
                managed: true
                overrides:
                  replicas: 1
              configBundleSecret: init-config-bundle-secret
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: quay-enf-storage
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: odf-inf-status
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: quay-enf-storage
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: objectbucket.io/v1alpha1
            kind: ObjectBucketClaim
            metadata:
              name: registry-quay
              namespace: quay-enterprise
            spec:
              generateBucketName: registry-quay
              storageClassName: ocs-storagecluster-ceph-rgw
            status:
              phase: Bound
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: PersistentVolume
            metadata:
              name: pv-quay-registry-postgresql-data
            spec:
              accessModes:
              - ReadWriteOnce
              capacity:
                storage: 50Gi
              claimRef:
                apiVersion: v1
                kind: PersistentVolumeClaim
                name: quay-registry-quay-postgres-13
                namespace: quay-enterprise
              nfs:
                path: /opt/woori/nfs/quay-registry/postgresql/data
                server: 192.168.10.12
              persistentVolumeReclaimPolicy: Retain
              volumeMode: Filesystem
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: PersistentVolumeClaim
            metadata:
              name: quay-registry-quay-postgres-13
              namespace: quay-enterprise
            spec:
              accessModes:
              - ReadWriteOnce
              resources:
                requests:
                  storage: 50Gi
              volumeMode: Filesystem
              volumeName: pv-quay-registry-postgresql-data
            status:
              phase: Bound
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: quay-inf-status
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: quay-enf-install
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: quay-inf-status
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: quay-registry-quay-app
              namespace: quay-enterprise
            status:
              conditions:
              - status: "True"
                type: Available
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: remediation-enf-config
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: remediation-enf-config
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: self-node-remediation.medik8s.io/v1alpha1
            kind: SelfNodeRemediationConfig
            metadata:
              name: self-node-remediation-config
              namespace: openshift-workload-availability
            spec:
              customDsTolerations:
              - effect: NoSchedule
                key: node-role.kubernetes.io/infra
                operator: Exists
        - complianceType: musthave
          objectDefinition:
            apiVersion: remediation.medik8s.io/v1alpha1
            kind: NodeHealthCheck
            metadata:
              name: nodehealthcheck-sample-worker
            spec:
              minHealthy: 51%
              remediationTemplate:
                apiVersion: self-node-remediation.medik8s.io/v1alpha1
                kind: SelfNodeRemediationTemplate
                name: self-node-remediation-automatic-strategy-template
                namespace: openshift-workload-availability
              selector:
                matchExpressions:
                - key: node-role.kubernetes.io/worker
                  operator: Exists
              unhealthyConditions:
              - duration: 300s
                status: "False"
                type: Ready
              - duration: 300s
                status: Unknown
                type: Ready
        - complianceType: musthave
          objectDefinition:
            apiVersion: remediation.medik8s.io/v1alpha1
            kind: NodeHealthCheck
            metadata:
              name: nodehealthcheck-sample-infra
            spec:
              minHealthy: 51%
              remediationTemplate:
                apiVersion: self-node-remediation.medik8s.io/v1alpha1
                kind: SelfNodeRemediationTemplate
                name: self-node-remediation-automatic-strategy-template
                namespace: openshift-workload-availability
              selector:
                matchExpressions:
                - key: node-role.kubernetes.io/infra
                  operator: Exists
              unhealthyConditions:
              - duration: 300s
                status: "False"
                type: Ready
              - duration: 300s
                status: Unknown
                type: Ready
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: sub-enf-approval-automatic
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: sub-approval-automatic
      spec:
        object-templates-raw: |
          {{- range $sub := (lookup "operators.coreos.com/v1alpha1" "Subscription" "" "!policies.ignore").items }}
          - complianceType: mustonlyhave
            objectDefinition:
              apiVersion: operators.coreos.com/v1alpha1
              kind: Subscription
              metadata:
                name: {{ $sub.metadata.name }}
                namespace: {{ $sub.metadata.namespace }}
              spec:
                installPlanApproval: Automatic
                name: {{ $sub.spec.name }}
                source: {{ $sub.spec.source }}
                sourceNamespace: {{ $sub.spec.sourceNamespace }}
                config: {{  $sub.spec.config | toRawJson | toLiteral }}
          {{- end }}
        remediationAction: enforce
        severity: high
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: sub-enf-approval-manual
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: sub-approval-manual
      spec:
        object-templates-raw: |
          {{- range $sub := (lookup "operators.coreos.com/v1alpha1" "Subscription" "" "!policies.ignore").items }}
          - complianceType: musthave
            objectDefinition:
              apiVersion: operators.coreos.com/v1alpha1
              kind: Subscription
              metadata:
                name: {{ $sub.metadata.name }}
                namespace: {{ $sub.metadata.namespace }}
              spec:
                installPlanApproval: Manual
          {{- end }}
        remediationAction: enforce
        severity: high
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: update-enf-proxy-sync
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: update-enf-proxy-sync
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              ca-bundle.crt: |
                {{hub fromConfigMap "policies" "router-bundle" "ca-bundle.crt" | autoindent hub}}
            kind: ConfigMap
            metadata:
              name: router-bundle
              namespace: openshift-config
        - complianceType: musthave
          objectDefinition:
            apiVersion: config.openshift.io/v1
            kind: Proxy
            metadata:
              name: cluster
            spec:
              trustedCA:
                name: router-bundle
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: opp-clusters
  namespace: policies
spec:
  description: The OpenShift Platform Plus policy set applies several policies that
    install the OpenShift Platform Plus products using best practices that allow them
    to work well together. This policy set is focused on the components that install
    to every managed cluster.
  policies:
  - advanced-enf-managed-cluster-security
  - advanced-inf-managed-cluster-status
  - csv-inf-check
  - cv-inf-check
  - remediation-enf-config
  - update-enf-proxy-sync
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: opp-hub
  namespace: policies
spec:
  description: The OpenShift Platform Plus policy set applies several policies that
    will install the OpenShift Platform Plus products using best practices that allow
    them to work well together. This policy set is focused on the components that
    install to the Advanced Cluster Management hub.
  policies:
  - acs-enf-central-ca-bundle
  - acs-enf-central-ca-bundle-expired
  - acs-enf-operator-central
  - acs-enf-sync-resources
  - acs-inf-central-status
  - acs-inf-monitor-certs
  - advanced-inf-managed-cluster-status
  - all-enf-operators-install
  - create-enf-router-bundle
  - csv-inf-check
  - cv-inf-check
  - hub-enf-operators-install
  - observability-enf-operator
  - observability-enf-storage
  - odf-enf
  - odf-enf-cluster
  - odf-inf-status
  - odf-inf-volume
  - quay-enf-config
  - quay-enf-install
  - quay-enf-storage
  - quay-inf-status
  - remediation-enf-config
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: sub-approval-automatic
  namespace: policies
spec:
  description: ""
  policies:
  - cs-enf-redhat-operator-update
  - sub-enf-approval-automatic
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: sub-approval-manual
  namespace: policies
spec:
  description: ""
  policies:
  - sub-enf-approval-manual
