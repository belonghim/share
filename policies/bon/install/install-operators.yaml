---
apiVersion: v1
kind: Namespace
metadata:
  name: openshift-logging
  annotations:
    scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
---
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: openshift-logging
  namespace: openshift-logging
spec:
  targetNamespaces:
  - openshift-logging
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: cluster-logging
  namespace: openshift-logging
  labels:
    policies.install: ""
spec:
  name: cluster-logging
  source: cs-redhat-operator-index
  sourceNamespace: openshift-marketplace
  config:
    nodeSelector:
      node-role.kubernetes.io/infra: ""
    tolerations:
    - effect: NoSchedule
      operator: Exists
      key: node-role.kubernetes.io/infra
---
apiVersion: v1
kind: Namespace
metadata:
  name: openshift-workload-availability
  annotations:
    scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
---
apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: openshift-workload-availability
  namespace: openshift-workload-availability
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: node-healthcheck-operator
  namespace: openshift-workload-availability
  labels:
    policies.install: ""
spec:
  name: node-healthcheck-operator
  source: cs-redhat-operator-index
  sourceNamespace: openshift-marketplace
  config:
    nodeSelector:
      node-role.kubernetes.io/infra: ""
    tolerations:
    - effect: NoSchedule
      operator: Exists
      key: node-role.kubernetes.io/infra
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: self-node-remediation
  namespace: openshift-workload-availability
  labels:
    policies.install: ""
spec:
  name: self-node-remediation
  source: cs-redhat-operator-index
  sourceNamespace: openshift-marketplace
  config:
    nodeSelector:
      node-role.kubernetes.io/infra: ""
    tolerations:
    - effect: NoSchedule
      operator: Exists
      key: node-role.kubernetes.io/infra
---
apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: node-maintenance-operator
  namespace: openshift-workload-availability
  labels:
    policies.install: ""
spec:
  name: node-maintenance-operator
  source: cs-redhat-operator-index
  sourceNamespace: openshift-marketplace
  config:
    nodeSelector:
      node-role.kubernetes.io/infra: ""
    tolerations:
    - effect: NoSchedule
      operator: Exists
      key: node-role.kubernetes.io/infra
---
apiVersion: policy.open-cluster-management.io/v1
kind: ConfigurationPolicy
metadata:
  name: install-operators-extra
spec:
  remediationAction: enforce
  severity: high
  object-templates-raw: |
    {{hub if ne "none" (index .ManagedClusterLabels "policies.extra") hub}}
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-nmstate
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-nmstate
          namespace: openshift-nmstate
        spec:
          targetNamespaces:
          - openshift-nmstate
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: kubernetes-nmstate-operator
          namespace: openshift-nmstate
          labels:
            policies.install: ""
        spec:
          name: kubernetes-nmstate-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-storage
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-storage
          namespace: openshift-storage
        spec:
          targetNamespaces:
          - openshift-storage
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: lvms-operator
          namespace: openshift-storage
          labels:
            policies.install: ""
        spec:
          name: lvms-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-gitops-operator
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-gitops
          annotations:
            openshift.io/node-selector: node-role.kubernetes.io/infra=
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-gitops-operator
          namespace: openshift-gitops-operator
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: openshift-gitops-operator
          namespace: openshift-gitops-operator
          labels:
            policies.install: ""
        spec:
          name: openshift-gitops-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-local-storage
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-local-storage
          namespace: openshift-local-storage
        spec:
          targetNamespaces:
          - openshift-local-storage
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: local-storage-operator
          namespace: openshift-local-storage
          labels:
            policies.install: ""
        spec:
          name: local-storage-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-operators
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: servicemeshoperator
          namespace: openshift-operators
          labels:
            policies.install: ""
        spec:
          name: servicemeshoperator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: kiali-ossm
          namespace: openshift-operators
          labels:
            policies.install: ""
        spec:
          name: kiali-ossm
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-distributed-tracing
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-distributed-tracing
          namespace: openshift-distributed-tracing
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: jaeger-product
          namespace: openshift-distributed-tracing
          labels:
            policies.install: ""
        spec:
          name: jaeger-product
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: web-terminal
          namespace: openshift-operators
          labels:
            policies.install: ""
        spec:
          name: web-terminal
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: devworkspace-operator
          namespace: openshift-operators
          labels:
            policies.install: ""
        spec:
          name: devworkspace-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-tempo-operator
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-tempo-operator
          namespace: openshift-tempo-operator
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: tempo-product
          namespace: openshift-tempo-operator
          labels:
            policies.install: ""
        spec:
          name: tempo-product
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-opentelemetry-operator
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-opentelemetry-operator
          namespace: openshift-opentelemetry-operator
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: opentelemetry-product
          namespace: openshift-opentelemetry-operator
          labels:
            policies.install: ""
        spec:
          name: opentelemetry-product
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-netobserv-operator
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-netobserv-operator
          namespace: openshift-netobserv-operator
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: netobserv-operator
          namespace: openshift-netobserv-operator
          labels:
            policies.install: ""
        spec:
          name: netobserv-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: node-observability-operator
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: node-observability-operator
          namespace: node-observability-operator
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: node-observability-operator
          namespace: node-observability-operator
          labels:
            policies.install: ""
        spec:
          name: node-observability-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-keda
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-keda
          namespace: openshift-keda
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: openshift-custom-metrics-autoscaler-operator
          namespace: openshift-keda
          labels:
            policies.install: ""
        spec:
          name: openshift-custom-metrics-autoscaler-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    - complianceType: musthave
      objectDefinition:
        apiVersion: v1
        kind: Namespace
        metadata:
          name: openshift-vertical-pod-autoscaler
          annotations:
            scheduler.alpha.kubernetes.io/defaultTolerations: '[{"operator":"Exists","effect":"NoSchedule","key":"node-role.kubernetes.io/infra"}]'
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1
        kind: OperatorGroup
        metadata:
          name: openshift-vertical-pod-autoscaler
          namespace: openshift-vertical-pod-autoscaler
        spec:
          targetNamespaces:
          - openshift-vertical-pod-autoscaler
    - complianceType: musthave
      objectDefinition:
        apiVersion: operators.coreos.com/v1alpha1
        kind: Subscription
        metadata:
          name: vertical-pod-autoscaler
          namespace: openshift-vertical-pod-autoscaler
          labels:
            policies.install: ""
        spec:
          name: vertical-pod-autoscaler
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
          config:
            nodeSelector:
              node-role.kubernetes.io/infra: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
              key: node-role.kubernetes.io/infra
    {{hub end hub}}
---
