apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: placement-manual-opp-clusters
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: vendor
          operator: In
          values:
          - OpenShift
        - key: local-cluster
          operator: NotIn
          values:
          - "true"
        - key: manual
          operator: Exists
---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: placement-manual-opp-hub
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: local-cluster
          operator: In
          values:
          - "true"
        - key: manual
          operator: Exists
---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: placement-opp-clusters
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: vendor
          operator: In
          values:
          - OpenShift
        - key: local-cluster
          operator: NotIn
          values:
          - "true"
        - key: manual
          operator: DoesNotExist
---
apiVersion: cluster.open-cluster-management.io/v1beta1
kind: Placement
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: placement-opp-hub
  namespace: policies
spec:
  predicates:
  - requiredClusterSelector:
      labelSelector:
        matchExpressions:
        - key: local-cluster
          operator: In
          values:
          - "true"
        - key: manual
          operator: DoesNotExist
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: placement-manual-opp-clusters
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: manual-opp-clusters
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub2
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: placement-manual-opp-hub
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: manual-opp-hub
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub3
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: placement-opp-clusters
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: opp-clusters
---
apiVersion: policy.open-cluster-management.io/v1
kind: PlacementBinding
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: binding-policy-opp-hub4
  namespace: policies
placementRef:
  apiGroup: cluster.open-cluster-management.io
  kind: Placement
  name: placement-opp-hub
subjects:
- apiGroup: policy.open-cluster-management.io
  kind: PolicySet
  name: opp-hub
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: automatic-all-operators-install
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: node-healthcheck-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-workload-availability
          namespace: openshift-workload-availability
        remediationAction: enforce
        severity: high
        subscription:
          name: node-healthcheck-operator
          namespace: openshift-workload-availability
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: self-node-remediation
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-workload-availability
          namespace: openshift-workload-availability
        remediationAction: enforce
        severity: high
        subscription:
          name: self-node-remediation
          namespace: openshift-workload-availability
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: cluster-logging
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-logging
          namespace: openshift-logging
        remediationAction: enforce
        severity: high
        subscription:
          name: cluster-logging
          namespace: openshift-logging
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: automatic-all-operators-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-workload-availability
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-logging
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: automatic-hub-operators-install
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: local-storage-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-local-storage
          namespace: openshift-local-storage
          targetNamespaces:
          - openshift-local-storage
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              cluster.ocs.openshift.io/openshift-storage: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: local-storage-operator
          namespace: openshift-local-storage
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: odf-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-storage
          namespace: openshift-storage
          targetNamespaces:
          - openshift-storage
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              cluster.ocs.openshift.io/openshift-storage: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: odf-operator
          namespace: openshift-storage
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        labels:
          operators.coreos.com/quay-operator.openshift-quay: ""
        name: quay-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-quay
          namespace: openshift-quay
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/quay: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: quay-operator
          namespace: openshift-quay
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: cincinnati-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-update-service
          namespace: openshift-update-service
          targetNamespaces:
          - openshift-update-service
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: cincinnati-operator
          namespace: openshift-update-service
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: servicemeshoperator
      spec:
        complianceType: musthave
        operatorGroup:
          name: global-operators
          namespace: openshift-operators
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: servicemeshoperator
          namespace: openshift-operators
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: kiali-ossm
      spec:
        complianceType: musthave
        operatorGroup:
          name: global-operators
          namespace: openshift-operators
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: kiali-ossm
          namespace: openshift-operators
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: tempo-product
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-tempo-operator
          namespace: openshift-tempo-operator
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: tempo-product
          namespace: openshift-tempo-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: Automatic
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: automatic-hub-operators-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-local-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-quay
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-update-service
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-operators
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-tempo-operator
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: create-router-bundle
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: router-ca-bundle-configmap
      spec:
        object-templates-raw: |
          {{- if ne (lookup "v1" "ConfigMap" "openshift-config" "router-bundle").kind "ConfigMap" -}}
          - complianceType: mustonlyhave
            objectDefinition:
              apiVersion: v1
              data:
                ca-bundle.crt: |
                  {{ ( fromSecret "openshift-ingress-operator" "router-ca" "tls.crt" ) | base64dec | autoindent }}
              kind: ConfigMap
              metadata:
                name: router-bundle
                namespace: openshift-config
          {{- end -}}
        remediationAction: enforce
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: create-router-bundle
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              ca-bundle.crt: |
                {{ ( fromConfigMap "openshift-config" "router-bundle" "ca-bundle.crt" ) | autoindent }}
            kind: ConfigMap
            metadata:
              name: router-bundle
              namespace: policies
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: manual-all-operators-install
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: node-healthcheck-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-workload-availability
          namespace: openshift-workload-availability
        remediationAction: enforce
        severity: high
        subscription:
          name: node-healthcheck-operator
          namespace: openshift-workload-availability
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: self-node-remediation
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-workload-availability
          namespace: openshift-workload-availability
        remediationAction: enforce
        severity: high
        subscription:
          name: self-node-remediation
          namespace: openshift-workload-availability
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: cluster-logging
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-logging
          namespace: openshift-logging
        remediationAction: enforce
        severity: high
        subscription:
          name: cluster-logging
          namespace: openshift-logging
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: manual-all-operators-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-workload-availability
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-logging
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: manual-hub-operators-install
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: local-storage-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-local-storage
          namespace: openshift-local-storage
          targetNamespaces:
          - openshift-local-storage
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              cluster.ocs.openshift.io/openshift-storage: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: local-storage-operator
          namespace: openshift-local-storage
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: odf-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-storage
          namespace: openshift-storage
          targetNamespaces:
          - openshift-storage
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              cluster.ocs.openshift.io/openshift-storage: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: odf-operator
          namespace: openshift-storage
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        labels:
          operators.coreos.com/quay-operator.openshift-quay: ""
        name: quay-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-quay
          namespace: openshift-quay
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/quay: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: quay-operator
          namespace: openshift-quay
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: cincinnati-operator
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-update-service
          namespace: openshift-update-service
          targetNamespaces:
          - openshift-update-service
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: cincinnati-operator
          namespace: openshift-update-service
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: servicemeshoperator
      spec:
        complianceType: musthave
        operatorGroup:
          name: global-operators
          namespace: openshift-operators
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: servicemeshoperator
          namespace: openshift-operators
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: kiali-ossm
      spec:
        complianceType: musthave
        operatorGroup:
          name: global-operators
          namespace: openshift-operators
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: kiali-ossm
          namespace: openshift-operators
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1beta1
      kind: OperatorPolicy
      metadata:
        name: tempo-product
      spec:
        complianceType: musthave
        operatorGroup:
          name: openshift-tempo-operator
          namespace: openshift-tempo-operator
        remediationAction: enforce
        severity: high
        subscription:
          config:
            nodeSelector:
              node-role.kubernetes.io/acm: ""
            tolerations:
            - effect: NoSchedule
              operator: Exists
          name: tempo-product
          namespace: openshift-tempo-operator
          source: cs-redhat-operator-index
          sourceNamespace: openshift-marketplace
        upgradeApproval: None
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: manual-hub-operators-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-local-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-storage
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-quay
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              labels:
                openshift.io/cluster-monitoring: "true"
              name: openshift-update-service
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-operators
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: Namespace
            metadata:
              name: openshift-tempo-operator
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: CA Assessment Authorization and
      Monitoring
    policy.open-cluster-management.io/controls: CA-7 Continuous Monitoring
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-observability-operator
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-observability-storage
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: thanos-secret
      spec:
        object-templates-raw: "{{- /* read the bucket data and noobaa endpoint access
          data */ -}}\n{{- $objBucket := (lookup \"objectbucket.io/v1alpha1\" \"ObjectBucket\"
          \"\" \"obc-openshift-storage-obc-observability\") }}\n{{- $awsAccess :=
          (lookup \"v1\" \"Secret\" \"openshift-storage\" \"obc-observability\") }}\n{{-
          /* create the thanos config file as a template */ -}}\n{{- $thanosConfig
          := `\ntype: s3\nconfig:\n  bucket: %[1]s\n  endpoint: %[2]s\n  insecure:
          true\n  access_key: %[3]s\n  secret_key: %[4]s`\n}}\n\n{{- /* create the
          secret using the thanos configuration template created above. */ -}}\n-
          complianceType: mustonlyhave\n  objectDefinition:\n    apiVersion: v1\n
          \   kind: Secret\n    metadata:\n      name: thanos-object-storage\n      namespace:
          open-cluster-management-observability\n    type: Opaque\n    data:\n      thanos.yaml:
          {{ (printf $thanosConfig $objBucket.spec.endpoint.bucketName \n                                            $objBucket.spec.endpoint.bucketHost
          \n                                            ($awsAccess.data.AWS_ACCESS_KEY_ID
          | base64dec) \n                                            ($awsAccess.data.AWS_SECRET_ACCESS_KEY
          | base64dec)\n                      ) | base64enc }}\n"
        remediationAction: enforce
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-observability-operator2
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              .dockerconfigjson: '{{- if eq (lookup "v1" "Secret" "open-cluster-management"
                "multiclusterhub-operator-pull-secret").kind "Secret" -}} {{- fromSecret
                "open-cluster-management" "multiclusterhub-operator-pull-secret" ".dockerconfigjson"
                -}} {{- else -}} {{- fromSecret "openshift-config" "pull-secret" ".dockerconfigjson"
                -}} {{- end -}}'
            kind: Secret
            metadata:
              name: multiclusterhub-operator-pull-secret
              namespace: open-cluster-management-observability
            type: kubernetes.io/dockerconfigjson
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-observability-operator3
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: observability.open-cluster-management.io/v1beta2
            kind: MultiClusterObservability
            metadata:
              name: observability
            spec:
              nodeSelector:
                node-role.kubernetes.io/acm: ""
              observabilityAddonSpec: {}
              storageConfig:
                metricObjectStorage:
                  key: thanos.yaml
                  name: thanos-object-storage
                storageClass: ocs-storagecluster-ceph-rbd
              tolerations:
              - effect: NoSchedule
                key: node-role.kubernetes.io/infra
                operator: Exists
        remediationAction: enforce
        severity: medium
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-observability-operator4
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: console.openshift.io/v1
            kind: ConsoleLink
            metadata:
              name: observability
            spec:
              applicationMenu:
                imageURL: https://upload.wikimedia.org/wikipedia/commons/3/3a/OpenShift-LogoType.svg
                section: Red Hat applications
              href: https://{{ (lookup "route.openshift.io/v1" "Route" "open-cluster-management-observability"
                "grafana").spec.host }}
              location: ApplicationMenu
              text: Red Hat Advanced Cluster Management Observability
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: CA Assessment Authorization and
      Monitoring
    policy.open-cluster-management.io/controls: CA-7 Continuous Monitoring
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-observability-storage
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-odf-status
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-observability-storage
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: objectbucket.io/v1alpha1
            kind: ObjectBucketClaim
            metadata:
              name: obc-observability
              namespace: openshift-storage
            spec:
              generateBucketName: obc-observability-bucket
              storageClassName: ocs-storagecluster-ceph-rgw
            status:
              phase: Bound
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-odf
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-odf
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: local.storage.openshift.io/v1alpha1
            kind: LocalVolumeDiscovery
            metadata:
              name: auto-discover-devices
              namespace: openshift-local-storage
            spec:
              nodeSelector:
                nodeSelectorTerms:
                - matchExpressions:
                  - key: cluster.ocs.openshift.io/openshift-storage
                    operator: Exists
              tolerations:
              - effect: NoSchedule
                key: node-role.kubernetes.io/infra
                operator: Exists
        - complianceType: musthave
          objectDefinition:
            apiVersion: local.storage.openshift.io/v1alpha1
            kind: LocalVolumeSet
            metadata:
              name: odf-localvolumeset
              namespace: openshift-local-storage
            spec:
              deviceInclusionSpec:
                deviceTypes:
                - disk
                minSize: 1Gi
              nodeSelector:
                nodeSelectorTerms:
                - matchExpressions:
                  - key: cluster.ocs.openshift.io/openshift-storage
                    operator: Exists
              storageClassName: odf-localvolumeset
              tolerations:
              - effect: NoSchedule
                key: node-role.kubernetes.io/infra
                operator: Exists
              volumeMode: Block
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: operator.openshift.io/v1
            kind: Console
            metadata:
              name: cluster
            spec:
              plugins:
              - odf-console
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-odf-cluster
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-odf
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-odf-cluster
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: ocs.openshift.io/v1
            kind: StorageCluster
            metadata:
              annotations:
                uninstall.ocs.openshift.io/cleanup-policy: delete
                uninstall.ocs.openshift.io/mode: graceful
              name: ocs-storagecluster
              namespace: openshift-storage
            spec:
              flexibleScaling: true
              monDataDirHostPath: /var/lib/rook
              placement:
                all:
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
                mds:
                  podAntiAffinity:
                    preferredDuringSchedulingIgnoredDuringExecution:
                    - podAffinityTerm:
                        labelSelector:
                          matchLabels:
                            app: rook-ceph-mds
                        topologyKey: kubernetes.io/hostname
                      weight: 49
                    - podAffinityTerm:
                        labelSelector:
                          matchLabels:
                            app: rook-ceph-mgr
                        topologyKey: kubernetes.io/hostname
                      weight: 48
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
                'noobaa-core:':
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
                rgw:
                  podAntiAffinity:
                    preferredDuringSchedulingIgnoredDuringExecution:
                    - podAffinityTerm:
                        labelSelector:
                          matchLabels:
                            app: rook-ceph-mds
                        topologyKey: kubernetes.io/hostname
                      weight: 47
                  tolerations:
                  - effect: NoSchedule
                    key: node.ocs.openshift.io/storage
                    operator: Exists
              storageDeviceSets:
              - count: 1
                dataPVCTemplate:
                  spec:
                    accessModes:
                    - ReadWriteOnce
                    resources:
                      requests:
                        storage: 1Gi
                    storageClassName: odf-localvolumeset
                    volumeMode: Block
                name: ocs-deviceset-localvolume
                replica: 3
        - complianceType: musthave
          objectDefinition:
            apiVersion: storage.k8s.io/v1
            kind: StorageClass
            metadata:
              annotations:
                storageclass.kubernetes.io/is-default-class: "true"
              name: ocs-storagecluster-ceph-rbd
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              CSI_PLUGIN_TOLERATIONS: |
                - key: node.ocs.openshift.io/storage
                  operator: Exists
                  effect: NoSchedule
              CSI_PROVISIONER_NODE_AFFINITY: cluster.ocs.openshift.io/openshift-storage=
              CSI_PROVISIONER_TOLERATIONS: |
                - effect: NoSchedule
                  operator: Exists
                  key: node.ocs.openshift.io/storage
            kind: ConfigMap
            metadata:
              name: rook-ceph-operator-config
              namespace: openshift-storage
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-odf-status
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-odf
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-odf-status
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: ocs-operator
              namespace: openshift-storage
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: rook-ceph-rgw-ocs-storagecluster-cephobjectstore-a
              namespace: openshift-storage
            status:
              conditions:
              - status: "True"
                type: Available
        - complianceType: musthave
          objectDefinition:
            apiVersion: ocs.openshift.io/v1
            kind: StorageCluster
            metadata:
              name: ocs-storagecluster
              namespace: openshift-storage
            status:
              phase: Ready
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-quay-config
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-quay-install
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-quay-config
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              host: '{{ (lookup "route.openshift.io/v1" "Route" "openshift-quay" "quay-registry-quay"
                ).spec.host }}'
            kind: ConfigMap
            metadata:
              name: quay-config
              namespace: policies
        - complianceType: musthave
          objectDefinition:
            apiVersion: console.openshift.io/v1
            kind: ConsoleLink
            metadata:
              name: quay
            spec:
              applicationMenu:
                imageURL: https://upload.wikimedia.org/wikipedia/commons/3/3a/OpenShift-LogoType.svg
                section: Red Hat applications
              href: https://{{ (lookup "route.openshift.io/v1" "Route" "openshift-quay"
                "quay-registry-quay" ).spec.host }}
              location: ApplicationMenu
              text: Red Hat Quay Enterprise Registry
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-quay-install
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-quay-storage
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: init-config-bundle-secret
      spec:
        object-templates-raw: |
          {{- /* read the bucket data and endpoint access data */ -}}
          {{- $objBucket := (lookup "objectbucket.io/v1alpha1" "ObjectBucket" "" "obc-openshift-quay-registry-quay") }}
          {{- $awsAccess := (lookup "v1" "Secret" "openshift-quay" "registry-quay") }}
          {{- /* create the quay config file as a template */ -}}
          {{- $quayConfig := `
          DISTRIBUTED_STORAGE_CONFIG:
            default:
              - RadosGWStorage
              - access_key: %[1]s
                bucket_name: %[2]s
                hostname: rook-ceph-rgw-ocs-storagecluster-cephobjectstore.openshift-storage.svc
                is_secure: true
                port: 443
                secret_key: %[3]s
                storage_path: /datastorage/registry-quay
          DISTRIBUTED_STORAGE_DEFAULT_LOCATIONS: []
          DISTRIBUTED_STORAGE_PREFERENCE:
            - default
          FEATURE_USER_INITIALIZE: true
          BROWSER_API_CALLS_XHR_ONLY: false
          SUPER_USERS:
          - quayadmin
          FEATURE_USER_CREATION: true
          FEATURE_SUPERUSERS_FULL_ACCESS: true`
          }}

          {{- /* create the secret using the quay configuration template created above. */ -}}
          - complianceType: mustonlyhave
            objectDefinition:
              apiVersion: v1
              kind: Secret
              metadata:
                name: init-config-bundle-secret
                namespace: openshift-quay
              type: Opaque
              data:
                config.yaml: {{ (printf $quayConfig ($awsAccess.data.AWS_ACCESS_KEY_ID | base64dec) $objBucket.spec.endpoint.bucketName ($awsAccess.data.AWS_SECRET_ACCESS_KEY | base64dec)) | base64enc }}
        remediationAction: enforce
        severity: high
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-quay-install
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            kind: ServiceAccount
            metadata:
              name: create-admin-user
              namespace: openshift-quay
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: Role
            metadata:
              name: create-admin-user
              namespace: openshift-quay
            rules:
            - apiGroups:
              - ""
              resources:
              - secrets
              verbs:
              - get
              - list
              - create
              - patch
              - update
              - delete
            - apiGroups:
              - route.openshift.io
              resources:
              - routes
              verbs:
              - get
              - list
            - apiGroups:
              - quay.redhat.com
              resources:
              - quayregistries
              verbs:
              - get
              - list
              - watch
        - complianceType: musthave
          objectDefinition:
            apiVersion: rbac.authorization.k8s.io/v1
            kind: RoleBinding
            metadata:
              name: create-admin-user
              namespace: openshift-quay
            roleRef:
              apiGroup: rbac.authorization.k8s.io
              kind: Role
              name: create-admin-user
            subjects:
            - kind: ServiceAccount
              name: create-admin-user
              namespace: openshift-quay
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              clair-config.yaml: aW5kZXhlcjoKICBjb25uc3RyaW5nOiBob3N0PTE5Mi4xNjguMTAuMTEgcG9ydD01NDMyIGRibmFtZT1jbGFpci1kYXRhYmFzZSB1c2VyPWNsYWlyYWRtaW4gcGFzc3dvcmQ9Y2xhaXJhZG1pbjEhIHNzbG1vZGU9ZGlzYWJsZQogIHNjYW5sb2NrX3JldHJ5OiAxMAogIGxheWVyX3NjYW5fY29uY3VycmVuY3k6IDUKICBtaWdyYXRpb25zOiB0cnVlCiAgYWlyZ2FwOiB0cnVlCiAgc2Nhbm5lcjoKICAgIHJlcG86CiAgICAgIHJoZWwtcmVwb3NpdG9yeS1zY2FubmVyOgogICAgICAgIHJlcG8yY3BlX21hcHBpbmdfZmlsZTogL2RhdGEvcmVwb3NpdG9yeS10by1jcGUuanNvbgogICAgcGFja2FnZToKICAgICAgcmhlbF9jb250YWluZXJzY2FubmVyOgogICAgICAgIG5hbWUycmVwb3NfbWFwcGluZ19maWxlOiAvZGF0YS9jb250YWluZXItbmFtZS1yZXBvcy1tYXAuanNvbgptYXRjaGVyOgogIGNvbm5zdHJpbmc6IGhvc3Q9MTkyLjE2OC4xMC4xMSBwb3J0PTU0MzIgZGJuYW1lPWNsYWlyLWRhdGFiYXNlIHVzZXI9Y2xhaXJhZG1pbiBwYXNzd29yZD1jbGFpcmFkbWluMSEgc3NsbW9kZT1kaXNhYmxlCiAgZGlzYWJsZV91cGRhdGVyczogdHJ1ZQogIG1heF9jb25uX3Bvb2w6IDEwMAogIG1pZ3JhdGlvbnM6IHRydWUKICBpbmRleGVyX2FkZHI6IGNsYWlyLWluZGV4ZXIKbm90aWZpZXI6CiAgY29ubnN0cmluZzogaG9zdD0xOTIuMTY4LjEwLjExIHBvcnQ9NTQzMiBkYm5hbWU9Y2xhaXItZGF0YWJhc2UgdXNlcj1jbGFpcmFkbWluIHBhc3N3b3JkPWNsYWlyYWRtaW4xISBzc2xtb2RlPWRpc2FibGUKICBkZWxpdmVyeV9pbnRlcnZhbDogMW0KICBwb2xsX2ludGVydmFsOiA1bQogIG1pZ3JhdGlvbnM6IHRydWUKICB3ZWJob29rOgogICAgY2FsbGJhY2s6IGh0dHA6Ly9xdWF5LXJlZ2lzdHJ5LWNsYWlyLWFwcC9ub3RpZmllci9hcGkvdjEvbm90aWZpY2F0aW9ucwogICAgdGFyZ2V0OiBodHRwczovL3JlZ2lzdHJ5LmFwcHMucGFhcy53b29yaWZnLmNvbS9zZWNzY2FuL25vdGlmaWNhdGlvbg==
              config.yaml: QVVUSEVOVElDQVRJT05fVFlQRTogT0lEQwpCQU5LX0xPR0lOX0NPTkZJRzoKICBDTElFTlRfSUQ6IHF1YXktZW50ZXJwcmlzZQogIENMSUVOVF9TRUNSRVQ6IHpaVnRGMERuTXpWNWpvR0FZOVBZZXRCeHVqUVNjV3NMCiAgT0lEQ19TRVJWRVI6IGh0dHBzOi8va2V5Y2xvYWsucGFhcy53b29yaWZnLmNvbTo4MTQzL3JlYWxtcy93b29yaS1yZWFsbS8KICBTRVJWSUNFX05BTUU6IFdvb3JpQmFuayBTU08KICBQUkVGRVJSRURfR1JPVVBfQ0xBSU1fTkFNRTogcXVheS1ncm91cAogIExPR0lOX1NDT1BFUzogWyAnb3BlbmlkJyBdCiAgT0lEQ19ESVNBQkxFX1VTRVJfRU5EUE9JTlQ6IGZhbHNlCkNBUkRfTE9HSU5fQ09ORklHOgogIENMSUVOVF9JRDogcXVheS1lbnRlcnByaXNlCiAgQ0xJRU5UX1NFQ1JFVDogUXBJU0w1Qkt2QWkwQmdtYzNJOVRUZWgydDBzQU9HOW0KICBPSURDX1NFUlZFUjogaHR0cHM6Ly9rZXljbG9hay5wYWFzLndvb3JpZmcuY29tOjgxNDMvcmVhbG1zL2NhcmQtcmVhbG0vCiAgU0VSVklDRV9OQU1FOiBXb29yaUNhcmQgU1NPCiAgUFJFRkVSUkVEX0dST1VQX0NMQUlNX05BTUU6IHF1YXktZ3JvdXAKICBMT0dJTl9TQ09QRVM6IFsgJ29wZW5pZCcgXQogIE9JRENfRElTQUJMRV9VU0VSX0VORFBPSU5UOiBmYWxzZQpGRUFUVVJFX1RFQU1fU1lOQ0lORzogdHJ1ZQpGRUFUVVJFX05PTlNVUEVSVVNFUl9URUFNX1NZTkNJTkdfU0VUVVA6IHRydWUKRkVBVFVSRV9VSV9WMjogdHJ1ZQpERUZBVUxUX1RBR19FWFBJUkFUSU9OOiAydwpQUkVGRVJSRURfVVJMX1NDSEVNRTogaHR0cApTRVJWRVJfSE9TVE5BTUU6IHJlZ2lzdHJ5LmFwcHMucGFhcy53b29yaWZnLmNvbQpTRVRVUF9DT01QTEVURTogdHJ1ZQpTVVBFUl9VU0VSUzoKICAtIHF1YXlhZG1pbgpGRUFUVVJFX1VTRVJfQ1JFQVRJT046IHRydWUKRkVBVFVSRV9VU0VSX0lOSVRJQUxJWkU6IHRydWUKRkVBVFVSRV9TVVBFUlVTRVJTX09SR19DUkVBVElPTl9PTkxZOiB0cnVlCkZFQVRVUkVfU1VQRVJVU0VSU19GVUxMX0FDQ0VTUzogdHJ1ZQpGRUFUVVJFX1JFU1RSSUNURURfVVNFUlM6IGZhbHNlIApSRVNUUklDVEVEX1VTRVJTX1dISVRFTElTVDoKICAtIHF1YXlhZG1pbgpCUk9XU0VSX0FQSV9DQUxMU19YSFJfT05MWTogZmFsc2UKVEFHX0VYUElSQVRJT05fT1BUSU9OUzoKICAtIDFkCiAgLSAxdwogIC0gMncKICAtIDR3CkRCX1VSSTogcG9zdGdyZXNxbDovL3F1YXlhZG1pbjpxdWF5YWRtaW4xIUAxOTIuMTY4LjEwLjExOjU0MzEvcXVheS1kYXRhYmFzZQpEQl9DT05ORUNUSU9OX0FSR1M6CiAgc3NsbW9kZTogZGlzYWJsZQo=
            kind: Secret
            metadata:
              name: quay-config-bundle
              namespace: openshift-quay
            type: Opaque
        - complianceType: musthave
          objectDefinition:
            apiVersion: quay.redhat.com/v1
            kind: QuayRegistry
            metadata:
              name: quay-registry
              namespace: openshift-quay
            spec:
              components:
              - kind: clairpostgres
                managed: false
              - kind: postgres
                managed: false
              - kind: mirror
                managed: false
              - kind: horizontalpodautoscaler
                managed: false
              configBundleSecret: quay-config-bundle
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-quay-status
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-quay-install
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-quay-status
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: apps/v1
            kind: Deployment
            metadata:
              name: quay-registry-quay-app
              namespace: openshift-quay
            status:
              conditions:
              - status: "True"
                type: Available
        remediationAction: inform
        severity: medium
  remediationAction: inform
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: policy-quay-storage
  namespace: policies
spec:
  dependencies:
  - apiVersion: policy.open-cluster-management.io/v1
    compliance: Compliant
    kind: Policy
    name: policy-odf-status
    namespace: policies
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: policy-quay-storage
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: objectbucket.io/v1alpha1
            kind: ObjectBucketClaim
            metadata:
              name: registry-quay
              namespace: openshift-quay
            spec:
              generateBucketName: registry-quay
              storageClassName: ocs-storagecluster-ceph-rgw
            status:
              phase: Bound
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1
kind: Policy
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
    policy.open-cluster-management.io/categories: SI System and Information Integrity
    policy.open-cluster-management.io/controls: SI-7 Software Firmware and Information
      Integrity
    policy.open-cluster-management.io/description: ""
    policy.open-cluster-management.io/standards: NIST SP 800-53
  labels:
    open-cluster-management.io/policy-set: opp
  name: update-proxy-sync
  namespace: policies
spec:
  disabled: false
  policy-templates:
  - objectDefinition:
      apiVersion: policy.open-cluster-management.io/v1
      kind: ConfigurationPolicy
      metadata:
        name: update-proxy-sync
      spec:
        object-templates:
        - complianceType: musthave
          objectDefinition:
            apiVersion: v1
            data:
              ca-bundle.crt: |
                {{hub fromConfigMap "policies" "router-bundle" "ca-bundle.crt" | autoindent hub}}
            kind: ConfigMap
            metadata:
              name: router-bundle
              namespace: openshift-config
        - complianceType: musthave
          objectDefinition:
            apiVersion: config.openshift.io/v1
            kind: Proxy
            metadata:
              name: cluster
            spec:
              trustedCA:
                name: router-bundle
        remediationAction: enforce
        severity: medium
  remediationAction: enforce
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: manual-opp-clusters
  namespace: policies
spec:
  description: ""
  policies:
  - manual-all-operators-install
  - update-proxy-sync
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: manual-opp-hub
  namespace: policies
spec:
  description: ""
  policies:
  - create-router-bundle
  - manual-all-operators-install
  - manual-hub-operators-install
  - policy-observability-operator
  - policy-observability-storage
  - policy-odf
  - policy-odf-cluster
  - policy-odf-status
  - policy-quay-config
  - policy-quay-install
  - policy-quay-status
  - policy-quay-storage
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: opp-clusters
  namespace: policies
spec:
  description: The OpenShift Platform Plus policy set applies several policies that
    install the OpenShift Platform Plus products using best practices that allow them
    to work well together. This policy set is focused on the components that install
    to every managed cluster.
  policies:
  - automatic-all-operators-install
  - update-proxy-sync
---
apiVersion: policy.open-cluster-management.io/v1beta1
kind: PolicySet
metadata:
  annotations:
    argocd.argoproj.io/compare-options: IgnoreExtraneous
  labels:
    open-cluster-management.io/policy-set: opp
  name: opp-hub
  namespace: policies
spec:
  description: The OpenShift Platform Plus policy set applies several policies that
    will install the OpenShift Platform Plus products using best practices that allow
    them to work well together. This policy set is focused on the components that
    install to the Advanced Cluster Management hub.
  policies:
  - automatic-all-operators-install
  - automatic-hub-operators-install
  - create-router-bundle
  - policy-observability-operator
  - policy-observability-storage
  - policy-odf
  - policy-odf-cluster
  - policy-odf-status
  - policy-quay-config
  - policy-quay-install
  - policy-quay-status
  - policy-quay-storage
